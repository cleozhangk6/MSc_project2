
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://msc.bc.ic.ac.uk/~mz5318/introduction/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.15">
    
    
      
        <title>1. Introduction - Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.c382b1dc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-introducion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning" class="md-header__button md-logo" aria-label="Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M160 320h12v16c0 8.875 7.125 16 16 16h40c8.875 0 16-7.125 16-16v-16h12c17.62 0 32-14.38 32-32V64c0-17.62-14.38-32-32-32V16c0-8.875-7.1-16-16-16h-64c-8.9 0-16 7.125-16 16v16c-17.6 0-32 14.38-32 32v224c0 17.6 14.4 32 32 32zm304 128h-1.25C493.2 414 512 369.2 512 320c0-105.9-86.13-192-192-192v64c70.63 0 128 57.38 128 128s-57.38 128-128 128H48c-26.5 0-48 21.5-48 48 0 8.9 7.125 16 16 16h480c8.875 0 16-7.125 16-16 0-26.5-21.5-48-48-48zm-360-32h208c4.375 0 8-3.625 8-8v-16c0-4.375-3.625-8-8-8H104c-4.37 0-8 3.6-8 8v16c0 4.4 3.63 8 8 8z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1. Introduction
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning" class="md-nav__button md-logo" aria-label="Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M160 320h12v16c0 8.875 7.125 16 16 16h40c8.875 0 16-7.125 16-16v-16h12c17.62 0 32-14.38 32-32V64c0-17.62-14.38-32-32-32V16c0-8.875-7.1-16-16-16h-64c-8.9 0-16 7.125-16 16v16c-17.6 0-32 14.38-32 32v224c0 17.6 14.4 32 32 32zm304 128h-1.25C493.2 414 512 369.2 512 320c0-105.9-86.13-192-192-192v64c70.63 0 128 57.38 128 128s-57.38 128-128 128H48c-26.5 0-48 21.5-48 48 0 8.9 7.125 16 16 16h480c8.875 0 16-7.125 16-16 0-26.5-21.5-48-48-48zm-360-32h208c4.375 0 8-3.625 8-8v-16c0-4.375-3.625-8-8-8H104c-4.37 0-8 3.6-8 8v16c0 4.4 3.63 8 8 8z"/></svg>

    </a>
    Inferring Sleep Stages in Drosophila Melanogaster with Ethoscope Data and Machine Learning
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Abstract
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1. Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1. Introduction
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#11-sleep-behaviours-in-drosophila-melanogaster" class="md-nav__link">
    1.1 Sleep Behaviours in Drosophila Melanogaster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-the-ethoscope" class="md-nav__link">
    1.2 The Ethoscope
  </a>
  
    <nav class="md-nav" aria-label="1.2 The Ethoscope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#f1-fly-behavioural-tracking-with-ethoscope" class="md-nav__link">
     F1. Fly Behavioural Tracking with Ethoscope
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-time-series-analysis" class="md-nav__link">
    1.3 Time Series Analysis
  </a>
  
    <nav class="md-nav" aria-label="1.3 Time Series Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#f2-the-hctsa-workflow" class="md-nav__link">
     F2. The HCTSA Workflow 
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../methods/" class="md-nav__link">
        2. Data & Methods
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        3. Results
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../discussion/" class="md-nav__link">
        4. Discussion
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        5. Conclusion & Future Work
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ethics/" class="md-nav__link">
        Ethical Considerations
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#11-sleep-behaviours-in-drosophila-melanogaster" class="md-nav__link">
    1.1 Sleep Behaviours in Drosophila Melanogaster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-the-ethoscope" class="md-nav__link">
    1.2 The Ethoscope
  </a>
  
    <nav class="md-nav" aria-label="1.2 The Ethoscope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#f1-fly-behavioural-tracking-with-ethoscope" class="md-nav__link">
     F1. Fly Behavioural Tracking with Ethoscope
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-time-series-analysis" class="md-nav__link">
    1.3 Time Series Analysis
  </a>
  
    <nav class="md-nav" aria-label="1.3 Time Series Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#f2-the-hctsa-workflow" class="md-nav__link">
     F2. The HCTSA Workflow 
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="1-introducion">1. Introducion</h1>
<h2 id="11-sleep-behaviours-in-drosophila-melanogaster">1.1 Sleep Behaviours in <em>Drosophila Melanogaster</em></h2>
<p>Sleep is an important yet complex physiological process that occurs in virtually every animal that has been studied so far, but its underpinnings and functions remain elusive despite the rapidly developing effort towards sleep analysis. Mammalian sleep is known to be a multistage process with varying sleep depth associated with changes in neuronal activity <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup><sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup><sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>. In humans, for example, electroencephalographic (<abbr title="Electroencephalogram">EEG</abbr>) recordings can be used to identify the different sleep stages which circulate between wake, light sleep, deep sleep, and rapid eye movement (<abbr title="Rapid Eye Movement">REM</abbr>). It is believed that different sleep stages may serve distinct biological functions. For instance, evidence has shown that deep sleep contributes to bodily recovery and growth <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>, while <abbr title="Rapid Eye Movement">REM</abbr> sleep is essential to cognitive functions such as memory and learning <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>. </p>
<div class="admonition info inline end">
<p class="admonition-title">Definitions</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1"><abbr title="Electroencephalogram">EEG</abbr></label><label for="__tabbed_1_2"><abbr title="Proboscis Extension">PE</abbr></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Electroencephalography (<abbr title="Electroencephalogram">EEG</abbr>) is a method that measures electrical activity in the brain using small, metal discs (electrodes) attached to the scalp <a href="https://en.wikipedia.org/wiki/Electroencephalography">(Wikipedia)</a>.</p>
</div>
<div class="tabbed-block">
<p>A proboscis in insects refers to the tubular mouthpart used for feeding and sucking. Proboscis extension (<abbr title="Proboscis Extension">PE</abbr>) can either occur spontaneously or in response to antennal stimulation <a href="https://en.wikipedia.org/wiki/Proboscis">(Wikipedia)</a>. </p>
</div>
</div>
</div>
</div>
<p>Over the last few decades, the fruit fly <em>Drosophila melanogaster</em> has been an increasingly popular model organism to understand how sleep is regulated by internal and external stimuli and how it affects other biological functions. The simplicity, cost-effectiveness, rapid developmental time, and relevance to human genetics and physiology have made <em>Drosophila</em> an indispensable tool <sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup>. In most current studies, the sleeping state in <em>Drosophila</em> is  defined by a simple metric: immobility for more than five minutes <sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup>, and it is often assumed to be homogenous throughout. Nevertheless, there has been increasing evidence that sleep in <em>Drosophila</em> is also a dynamic process with differing sleep intensities <sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup>. Methods including <abbr title="Electroencephalogram">EEG</abbr> recordings, arousal-testing, and Proboscis Extension (<abbr title="Proboscis Extension">PE</abbr>) measurements have been used together to show that <em>Drosophila</em> exhibits a deep sleep stage which is characterised by  1) reduced neural activity, 2) increased immobility, 3) increased arousal threshold, and 4) stereotypical <abbr title="Proboscis Extension">PE</abbr> movement, namely the periodic extensions and retractions of the proboscis  <sup id="fnref:9"><a class="footnote-ref" href="#fn:9">9</a></sup><sup id="fnref:10"><a class="footnote-ref" href="#fn:10">10</a></sup>. These studies also indicated that <em>Drosophila</em> sleep follows a circadian rhythm, where flies sleep the most during start of the night, and it is also under homeostatic control as sleep deprivation leads to increased sleep amount and reduced sleep latency <sup id="fnref2:10"><a class="footnote-ref" href="#fn:10">10</a></sup>. </p>
<p>In this study, we turn to a novel method of measuring <em>Drosophila</em> behaviours using the Ethoscope, developed in the <a href="https://lab.gilest.ro/">Gilestro lab</a>, which can track the movement of a single fly housed in a glass tube <sup id="fnref:11"><a class="footnote-ref" href="#fn:11">11</a></sup>. This provides a simple, non-invasive, and high-throughput measurement of the external behaviour of sleep. The aim is to try and identify patterns in <em>Drosophila</em> locomotive data that can infer distinct sleep stages as indicated in previous research. </p>
<h2 id="12-the-ethoscope">1.2 The Ethoscope</h2>
<p>An ethoscope contains a hardware that video-records the fly in a longitudinal glass tube and a software to track its activity in real-time by applying an oval mask over the fly with machine vision algorithms <a href="#fig1">(Figure 1A &amp; 1B)</a>. The software can therefore track the <code>x</code>, <code>y</code> coordinates, width <code>w</code> and height <code>h</code> of the oval mask, and the angle <code>phi</code> between the line of W and the horizontal axis of the tube arena <a href="#fig1">(Figure 1C)</a>. This results in five different series of values recorded over time, which are called time series, for each fly <a href="#fig1">(Figure 1D)</a>. The ethoscope software also includes algorithms to calculate the <code>maximum velocity</code> and <code>mean velocity</code> at each time point, as well as behavioural annotators to indicate whether the fly is moving, exhibiting micro-movement, or immobile at a given time point.</p>
<h4 id="f1-fly-behavioural-tracking-with-ethoscope"><p class="hide-title"> F1. Fly Behavioural Tracking with Ethoscope</p><a name="fig1"></a></h4>
<p><img alt="pic" src="../img/ethoscope.png" /></p>
<p class="fig-cap">
<b>Figure 1. Fly Behavioural Tracking with Ethoscope.</b> 
A) Rendered drawing of an Ethoscope device. 
B) An image from a live Ethoscope showing 10 tubes and the corresponding oval masks over each fly.
C) A graphic representation of the oval mask and the variables x, y, w, h and phi of a single fly. 
D) A screenshot of example outputs of the Ethoscope. t is the time variable. 

</p>
<h2 id="13-time-series-analysis">1.3 Time Series Analysis</h2>
<p>As time series data arises in a wide variety of research fields, ranging from stock market forecasting to heart rate variability analysis, numerous tools have been developed to identify patterns in massive, continuous time series data. However, it would be time-consuming and sometimes insufficient to carry out individual analysis and compare simple statistics on the time series data to look for meaningful patterns, especially when little is known about the underlying data structure. As a result, the highly comparative time series analysis (<abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr>) toolkit is implemented to allow automatic data mining for our fly behavioural time series. <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr> systematically performs over 7,700 statistical analyses, adopted from literatures of different disciplines, on each time series <sup id="fnref:12"><a class="footnote-ref" href="#fn:12">12</a></sup>. This creates a M x N feature matrix, where M is the number of labelled time series samples and N is the number of statistical operations (also called time series features). Following the massive feature extraction, machine learning tasks such as principal component analysis and classification algorithms can then be performed to quantify similarity between the differently labelled groups <a href="#fig2">(Figure 2)</a>. </p>
<h4 id="f2-the-hctsa-workflow"><p class="hide-title"> F2. The <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr> Workflow </p><a name="fig2"></a></h4>
<p><img alt="pic" src="../img/hctsa.png" /></p>
<p class="fig-cap"> 
<b>Figure 2. Highly Comparative Time Series Analysis (HCTSA) workflow.</b> 
A set of time-series data is labelled and used as input dataset. HCTSA computes over 7,000 operations on each time-series data to create a MxN feature matrix (M = number of timeseries, N = number of operations). After feature extraction, statistical learning tools such as dimensionality reduction and classification algorithms can be used to analyse the data.
</p>

<p></br>
In addition to <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr>, it is also possible to compute a reduced number of operations using Canonical Time-series Characteristics (<abbr title="Canonical Time-series Characteristics">Catch22</abbr>), a toolbox that has preselected 22 most representative time-series features from the <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr> library <sup id="fnref:13"><a class="footnote-ref" href="#fn:13">13</a></sup>. This significantly decreases the computation time. Therefore, <abbr title="Canonical Time-series Characteristics">Catch22</abbr> is carried out first in every analysis, and HCSTA is performed if the <abbr title="Canonical Time-series Characteristics">Catch22</abbr> yields interesting results. </p>
<p>An advantage of using <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr> compared to other methods such as deep neutral network on time series classification is that <abbr title="Highly Comparative Time Series Analysis">HCTSA</abbr> encompasses interpretable and well-documented features. This allows useful understanding of the factors that potentially differentiates deep and light sleep in <em>Drosophila</em>. It also provides scope for incorporating a simplistic algorithm to the Ethoscope software that can apply the selected features on newly recorded time series data to indicate sleep stage. </p>
<p></br></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Blake H, Gerard RW. Brain potentials during sleep. Am J Physiol-Leg Content. 1937 Jul 31;119(4):692–703.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Wolpert EA. A Manual of Standardized Terminology, Techniques and Scoring System for Sleep Stages of Human Subjects. Arch Gen Psychiatry. 1969 Feb 1;20(2):246–7.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Webb WB, Agnew HW. Stage 4 sleep: influence of time course variables. Science. 1971 Dec 24;174(4016):1354–6.&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Yordanova J, Kolev V, Wagner U, Verleger R. Differential associations of early- and late-night sleep with functional brain states promoting insight to abstract task regularity. PloS One. 2010 Feb 26;5(2):e9442.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Drago V, Foster PS, Heilman KM, Aricò D, Williamson J, Montagna P, et al. Cyclic alternating pattern in sleep and its relationship to creativity. Sleep Med. 2011 Apr;12(4):361–6.&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>Dissel S. Drosophila as a Model to Study the Relationship Between Sleep, Plasticity, and Memory. Front Physiol [Internet]. 2020 [cited 2022 Jun 6];11. Available from:<a href="https://www.frontiersin.org/article/10.3389/fphys.2020.00533">https://www.frontiersin.org/article/10.3389/fphys.2020.00533</a>&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>Cirelli C, Bushey D. Sleep and wakefulness in Drosophila melanogaster. Ann N Y Acad Sci. 2008;1129:323–9.&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>Tainton-Heap LAL, Kirszenblat LC, Notaras ET, Grabowska MJ, Jeans R, Feng K, et al. A Paradoxical Kind of Sleep in Drosophila melanogaster. Curr Biol CB. 2021 Feb 8;31(3):578-590.e6.&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:9">
<p>van Alphen B, Yap MHW, Kirszenblat L, Kottler B, van Swinderen B. A Dynamic Deep Sleep Stage in Drosophila. J Neurosci. 2013 Apr 17;33(16):6917–27.&#160;<a class="footnote-backref" href="#fnref:9" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:10">
<p>van Alphen B, Semenza ER, Yap M, van Swinderen B, Allada R. A deep sleep stage in Drosophila with a functional role in waste clearance. Sci Adv. 2021 Jan 20;7(4):eabc2999.&#160;<a class="footnote-backref" href="#fnref:10" title="Jump back to footnote 10 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:10" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn:11">
<p>Geissmann Q, Rodriguez LG, Beckwith EJ, French AS, Jamasb AR, Gilestro GF. Ethoscopes: An open platform for high-throughput ethomics. PLOS Biol. 2017 Oct 19;15(10):e2003026.&#160;<a class="footnote-backref" href="#fnref:11" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
<li id="fn:12">
<p>Fulcher BD, Jones NS. hctsa : A Computational Framework for Automated Time-Series Phenotyping Using Massive Feature Extraction. Cell Syst. 2017 Nov;5(5):527-531.e3.&#160;<a class="footnote-backref" href="#fnref:12" title="Jump back to footnote 12 in the text">&#8617;</a></p>
</li>
<li id="fn:13">
<p>Lubba CH, Sethi SS, Knaute P, Schultz SR, Fulcher BD, Jones NS. catch22: CAnonical Time-series CHaracteristics. Data Min Knowl Discov. 2019 Nov 1;33(6):1821–52.&#160;<a class="footnote-backref" href="#fnref:13" title="Jump back to footnote 13 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Abstract" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Abstract
            </div>
          </div>
        </a>
      
      
        
        <a href="../methods/" class="md-footer__link md-footer__link--next" aria-label="Next: 2. Data &amp; Methods" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              2. Data & Methods
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Meng Zhang
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://www.linkedin.com/in/meng-zhang-293b6a194/" target="_blank" rel="noopener" title="linked" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77Z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/cleozhangk6" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["content.tooltips"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a6c66575.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>